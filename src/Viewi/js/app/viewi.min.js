(function(e,n){function t(){var t=this,i={},s={},a={},c=/^\s*|\s*$/g,d=/;$/g,l={onViewiUrlChange:null};"img,embed,object,link,script,audio,video,style".split(",").each(function(e){a[e]=!0});var p=[],u=new o;this.componentsUrl=VIEWI_PATH+"/components.json"+VIEWI_VERSION,this.components={};var f=document.createElement("a"),h=!1,m=null,v=function(e){return f.href=e,f.pathname},N=function(){for(var e in a)for(var n=document.getElementsByTagName(e),t=0;t<n.length;t++)p.push(n[t])},b=function(){t.components._meta.tags.split(",").each(function(e){i[e]=!0}),t.components._meta.boolean.split(",").each(function(e){s[e]=!0}),t.components._routes.each(function(e){u.register(e.method,e.url,e.component)}),m=t.components._config,N(),h=!0,t.go(location.href,!1)};this.getConfig=function(){return m},this.start=function(){"undefined"!=typeof onViewiUrlChange&&"function"==typeof onViewiUrlChange&&(l.onViewiUrlChange=onViewiUrlChange),"undefined"!=typeof ViewiPages?(t.components=JSON.parse(ViewiPages),b()):r.get(this.componentsUrl).then(function(e){t.components=e,b()}),document.addEventListener("click",function(e){if(e=e||window.event,!e.defaultPrevented){var n=e.target||e.srcElement,o=n;o.parentNode&&"A"===o.parentNode.tagName&&(o=o.parentNode),"A"===o.tagName&&o.href&&0===o.href.indexOf(location.origin)&&(v(o.href),f.hash&&f.pathname===location.pathname||(e.preventDefault(),t.go(o.href,!0),f.hash&&f.click()))}},!1),window.addEventListener("popstate",function(e){e.state?t.go(e.state.href,!1):t.go(location.href,!1)})},this.go=function(e,n){var o=v(e);l.onViewiUrlChange&&l.onViewiUrlChange(o);var r=u.resolve(o);if(null==r)throw"Can't resolve route for uri: "+o;n&&window.history.pushState({href:e},"",e),t.render(r.item.action,r.params)};var g=[],y=function(e,n){var t=arguments.length>2&&arguments[2];arguments.length>3&&arguments[3];if(e.expression){var o={call:!0,instance:n},r=["_component","app"];return(t||e.setter)&&r.push("event"),r=e.scope?r.concat(e.scope.stack):r.concat(g),e.code=e.code.replace(c,""),e.code=e.code.replace(d,""),e.setter?r.push(e.isChecked?"if(Array.isArray("+e.code+")) {  if ("+e.code+".indexOf(event.target.value) === -1) { event.target.checked && "+e.code+".push(event.target.value);event.target.checked && notify("+e.code+");  } else { !event.target.checked && "+e.code+".splice("+e.code+".indexOf(event.target.value), 1);!event.target.checked && notify("+e.code+");  }  } else { "+e.code+" = event.target.checked; } ":e.code+" = event.target.multiple ? Array.prototype.slice.call(event.target.options).where(function(x){ return x.selected; }).select(function(x){ return x.value; }) : event.target.value;"):r.push("return "+e.code+";"),o.code=e.code,o.func=Function.apply(null,r),o}return{call:!1,content:e.content}},w=["template"],x=["if","else-if","else","foreach"],_=["if","else-if","else"],k=[],E=function(e,n){var t=arguments.length>2&&arguments[2],o=arguments.length>3?arguments[3]:null,r=o&&!o.isRoot?o:null,i=arguments.length>4&&arguments[4],s=e.children,a=[],c=!1,d=null,l={};for(var p in s){var u=s[p];if("tag"!==u.type||"slot"!==u.content)if(!u.raw&&c&&("text"===u.type&&"text"===c.type||"comment"===u.type&&"comment"===c.type))c.contents.push(y(u,n)),u.subs&&(c.subs=(c.subs||[]).concat(u.subs));else{var f=null;u.attributes&&(f=u.attributes.first(function(e){return-1!==x.indexOf(e.content)&&-1===k.indexOf(e.content)}));var h=!1;if(c={id:++j,type:u.type,contents:[y(u,n)],domNode:null,parent:r,instance:n,previousNode:d,subs:u.subs},u.raw&&(c.type="raw",c.isVirtual=!0),r&&r.condition&&(c.condition=r.condition),d&&(d.nextNode=c),d=c,"tag"===u.type&&u.expression&&(c.type="dynamic",c.componentChildren=u.children,c.isVirtual=!0),null===f&&"tag"===u.type&&-1!==w.indexOf(u.content)){var m=u.content;c.type=m,c.isVirtual=!0}if(r&&r.scope&&(c.scope=r.scope),null===f)if(k.length>0&&(k=[]),"component"===u.type&&(h=u.content),childNodes=!1,u.children&&(childNodes=E(u,n,t,c)),u.attributes&&(c.attributes=u.attributes.where(function(e){return-1===x.indexOf(e.content)}).select(function(e){var t={},o=!e.expression&&"("===e.content[0];return t.content=e.content,t.isAttribute=!0,t.parent=c,t.contentExpression=y(e,n),t.instance=c.instance,e.dynamic&&(t.dynamic=e.dynamic),c.scope&&(t.scope=c.scope),e.children&&(t.children=e.children.select(function(t){var r={},i="model"===e.content;return r.contentExpression=y(t,n,o,i),"dynamic"!==c.type&&"component"!==c.type||(r.propExpression=y(t,n,null,!0),t.subs&&(r.subs=t.subs)),r.content=t.content,t.subs&&!o&&(r.subs=(r.subs||[]).concat(t.subs)),r})),e.subs&&!o&&(t.subs=(t.subs||[]).concat(e.subs)),t.origin=e,t})),h){var v=!1;i&&(he=!0,v=!0);var N=ce(h,childNodes,c.attributes);o.childInstances||(o.childInstances=[]),o.childInstances.push(N),v&&(he=!1);var b="main";if(N.wrapper.hasVersions&&(C(N.wrapper),V(N.wrapper),b=N.wrapper&&N.wrapper.component.__version&&N.wrapper.component.__version(),!b))throw new Error("Component '"+N.wrapper.name+"' doesn't support versioning!");if(!(b in N.versions))throw new Error("Can't find version '"+b+"' for component '"+N.wrapper.name+"'!");S=a.length>0?a[a.length-1]:null,$=[];N.versions[b].each(function(e){!S||"text"!==S.type||"text"!==e.type||e.raw||S.raw?(e.nextNode=null,e.parent=r,e.previousNode=S,S&&(S.nextNode=e),S=e,$.push(e)):S.contents=S.contents.concat(e.contents)}),a=a.concat($),d=a.length>0?a[a.length-1]:null}else childNodes&&("dynamic"===c.type||"raw"===c.type?c.itemChildren=childNodes:c.children=childNodes),a.push(c);else{if(c.type=f.content,"if"===c.type&&(l={}),c.isVirtual=!0,k.push(f.content),-1!==_.indexOf(c.type)&&(c.condition=f.children?y(f.children[0],n):{},f.children&&f.children[0].subs))for(var I in c.subs=f.children[0].subs,f.children[0].subs)l[f.children[0].subs[I]]=!0;var O=!1;if("foreach"===c.type&&f.children){O=f.children[0],O.subs&&(c.subs=(c.subs||[]).concat(O.subs)),c.forExpression={};var arguments=["_component","app"].concat(g);arguments.push("return "+O.forData+";"),c.forExpression.data=Function.apply(null,arguments),c.forExpression.key=O.forKey,c.forExpression.value=O.forItem,g.push(O.forKey),g.push(O.forItem),c.scope={stack:[],data:{}}}if(c.children=E({children:[u]},n,t,c),c.childInstances&&(c.children[0].childInstances=c.childInstances,delete c.childInstances),O){var A=g.indexOf(O.forKey);A>-1&&g.splice(A,1),A=g.indexOf(O.forItem),A>-1&&g.splice(A,1)}a.push(c)}}else{!0;var P=u.attributes&&u.attributes.first(function(e){return"name"===e.content}),B=0,T=function(e){return!e.attributes};P&&(B=P.children[0].content,T=function(e){return e.attributes&&e.attributes.first(function(e){return"name"===e.content&&e.children[0].content===B})});var R=!0;if(t){if(0===B){var L=t.where(function(e){return"tag"!==e.type||"slotContent"!==e.contents[0].content});if(L.length>0){R=!1;var S=a.length>0?a[a.length-1]:null,$=[];L.each(function(e){!S||"text"!==S.type||"text"!==e.type||e.raw||S.raw?(e.nextNode=null,e.parent=r,e.previousNode=S,S&&(S.nextNode=e),S=e,$.push(e)):S.contents=S.contents.concat(e.contents)}),a=a.concat($)}}else{var H=t.first(function(e){return"tag"===e.type&&"slotContent"===e.contents[0].content&&T(e)});if(H){R=!1;var S=a.length>0?a[a.length-1]:null,$=[];H.children.each(function(e){!S||"text"!==S.type||"text"!==e.type||e.raw||S.raw?(e.nextNode=null,e.parent=r,e.previousNode=S,S&&(S.nextNode=e),S=e,$.push(e)):S.contents=S.contents.concat(e.contents)}),a=a.concat($)}}d=a.length>0?a[a.length-1]:null}if(R){var D=E(u,n,!1,r);S=a.length>0?a[a.length-1]:null,$=[];D.each(function(e){!S||"text"!==S.type||"text"!==e.type||e.raw||S.raw?(e.nextNode=null,e.parent=r,e.previousNode=S,S&&(S.nextNode=e),S=e,$.push(e)):S.contents=S.contents.concat(e.contents)}),a=a.concat($),d=a.length>0?a[a.length-1]:null}}}return a},V=function(e){if(!e.isMounted){if(e.component.__beforeMount&&e.component.__beforeMount(),e.attributes)for(var n in e.attributes){var o=e.attributes[n],r="("===o.content[0],i=null;if(r){var s=o.content;i=s.substring(1,s.length-1);var a=null;o.dynamic?(o.eventExpression||(o.instance.component||(o.instance.component=C(o.instance)),o.eventExpression=y(o.dynamic,o.instance,!0)),a=o.eventExpression.func):a=o.children[0].contentExpression.func,o.listeners||(o.listeners={}),o.listeners[s]&&elm.removeEventListener(i,o.listeners[s]),o.listeners[s]=function(e){var n=[o.instance.component,t,e];if(o.scope)for(var r in o.scope.stack)n.push(o.scope.data[o.scope.stack[r]]);a.apply(null,n)},e.component.$_callbacks||(e.component.$_callbacks={}),e.component.$_callbacks[i]=o.listeners[s]}var c=null,d=null;for(var l in o.children){var p=o.children[l].propExpression;if(p.call){o.instance.component||(o.instance.component=C(o.instance),V(o.instance));var u=[o.instance.component,t];if(o.scope)for(var f in o.scope.stack)u.push(o.scope.data[o.scope.stack[f]]);d=r?e.component.$_callbacks[i]:p.func.apply(null,u),o.children[l].subs&&(Y["this."+o.content]={instance:o.instance,subs:o.children[l].subs})}else d=p.content;l>0?c+=d:c=d}if("_props"!==o.content)"true"===c?c=!0:"false"===c&&(c=!1),o.content in e.component&&(e.component[o.content]=c),e.component._props[o.content]=c;else for(var h in c){if(h in e.component&&(e.component[h]=c[h]),"("===h[0]){i=h.substring(1,h.length-1);e.component.$_callbacks||(e.component.$_callbacks={}),e.component.$_callbacks[i]=c[h]}e.component._props[h]=c[h]}}e.component.__mounted&&e.component.__mounted(),e.isMounted=!0}},C=function(e){if(!e.component){var n=re(e.name,e.params,e.__id);if(e.component=n,e.isCreated=!0,e.attributes)for(a=0;a<e.attributes.length;a++){var t=e.attributes[a],o=!t.expression&&"("===t.content[0];if(t.childComponent=n,!o){if(t.subs)for(var r in t.subs)G(t,t.subs[r]);if(t.children)for(var i=0;i<t.children.length;i++){var s=t.children[i];if(s.subs)for(var r in s.subs)G(t,s.subs[r])}}}return Ne[e.name+"__"+e.__id]=e,n}if(e.attributes)for(var a=0;a<e.attributes.length;a++)e.attributes[a].childComponent=e.component},I=function(e,n,o){if(e)try{var r=n.content;if(n.contentExpression.call){n.instance.component||(n.instance.component=C(n.instance));var i=[n.instance.component,t];if(n.scope)for(var a in n.scope.stack)i.push(n.scope.data[n.scope.stack[a]]);if(r=n.contentExpression.func.apply(null,i),n.latestValue&&n.latestValue!==r&&(e.removeAttribute(n.latestValue),n.listeners&&n.latestValue in n.listeners)){var c=n.latestValue.substring(1,n.latestValue.length-1);e.removeEventListener(c,n.listeners[n.latestValue])}n.latestValue=r}if("#"===r[0])return void(n.instance.component._refs[r.substring(1)]=e);if("("===r[0]){if(h&&!o)return;c=r.substring(1,r.length-1);var d=null;n.dynamic?(n.eventExpression||(n.instance.component||(n.instance.component=C(n.instance)),n.eventExpression=y(n.dynamic,n.instance,!0)),d=n.eventExpression.func):d=n.children[0].contentExpression.func,n.listeners||(n.listeners={}),n.listeners[r]&&e.removeEventListener(c,n.listeners[r]),n.listeners[r]=function(e){var o=[n.instance.component,t,e];if(n.scope)for(var r in n.scope.stack)o.push(n.scope.data[n.scope.stack[r]]);d.apply(null,o)},e.addEventListener(c,n.listeners[r])}else{if(o&&"model"!==r)return;if(n.subs&&!n.subscribed){for(var l in n.subs)G(n,n.subs[l]);n.subscribed=!0}var p=!1,u=!0;r in s&&(p=!0);var f=[];for(var m in n.children){if(n.children[m].subs&&!n.children[m].subscribed){for(var l in n.children[m].subs)G(n,n.children[m].subs[l]);n.children[m].subscribed=!0}var v=n.children[m].contentExpression;if(v.call){n.instance.component||(n.instance.component=C(n.instance));i=[n.instance.component,t];if(n.scope)for(var a in n.scope.stack)i.push(n.scope.data[n.scope.stack[a]]);u=v.func.apply(null,i),f.push(u)}else f.push(v.content)}if(p)return void(u?e.setAttribute(r,r):e.removeAttribute(r));var N="model"===r,b=f.join("");if(N){if(h&&!o)return;var g="checkbox"===e.getAttribute("type"),w="radio"===e.getAttribute("type"),x="SELECT"===e.tagName,_=x&&e.multiple,k=g||w;if(k||_||(e.value=b),w){var E=e.getAttribute("checked");e.value!=b&&E?(e.removeAttribute("checked"),e.checked=!1):e.value!=b||E||(e.setAttribute("checked","checked"),e.checked=!0)}c=k||x?"change":"input";if(n.listeners||(n.listeners={}),!n.valueExpression&&n.children.length>0){n.instance.component||(n.instance.component=C(n.instance));i=[n.instance.component,t];var V=[];if(n.scope)for(var a in n.scope.stack)V.push(n.scope.data[n.scope.stack[a]]);n.valueExpression=y({code:n.children[0].contentExpression.code,expression:!0,setter:!0,isChecked:g,isMultiple:_,scope:n.scope},n.instance);d=n.valueExpression.func;n.listeners[c]=function(e){d.apply(null,i.concat([e]).concat(V))}}e.removeEventListener(c,n.listeners[c]),e.addEventListener(c,n.listeners[c])}else null===f[0]?e.removeAttribute(r):e.getAttribute(r)!==b&&e.setAttribute(r,b)}}catch(e){console.error(e),console.log(n.content)}},O=function(e){for(var n=e,t=!0,o=!1,r=!1;!n.domNode||t;)if(t=!1,null!==n.previousNode){if(n=n.previousNode,o=!1,n.isVirtual){if(n===r)throw new Error("Can't find the node before current!");r=n;for(var i=n;null!==i&&!i.domNode;)i=i.isVirtual&&i.children?i.children[i.children.length-1]:null;i&&(n=i)}}else{if(null===n.parent)return null;n=n.parent,o=!0}return{itsParent:o,node:n}},j=0,A=function(e,n,o,r){if(!r&&(n.isVirtual||"text"===n.type)){for(var s=n;s.parent&&s.parent.isVirtual;)s=s.parent;for(var c=O(n),d=(c&&c.itsParent?c.node.domNode:c&&c.node.domNode.parentNode)||e,l=s;l.previousNode&&(l.previousNode.isVirtual||"text"===l.previousNode.type);)l=l.previousNode;for(var u=s;u.nextNode&&(u.nextNode.isVirtual||"text"===u.nextNode.type);)u=u.nextNode;if(l!==s||u!==s){for(var f=l,m=!0;m;)A(d,f,!0,!0),f.isVirtual&&f===n.parent&&A(d,n,!0,!0),m=f!==u,f=f.nextNode;return}}if(n.renderIteration!==we){if(n.renderIteration=we,o){var v=n.parent&&n.parent.condition,N=v&&v.value;if(v&&!N)return void H([n])}if(n.isVirtual||!n.condition||n.condition.value){n.instance.component||(n.instance.component=C(n.instance)),n.instance.isMounted||V(n.instance);var b=[];for(var g in n.contents){var y=n.contents[g];if(y.call){var w=[y.instance.component,t];if(n.scope)for(var x in n.scope.stack)w.push(n.scope.data[n.scope.stack[x]]);b.push(y.func.apply(null,w))}else b.push(y.content)}var _=b.join(""),k=!1,E=!1;if(n.skipIteration){n.skipIteration=!1;for(var j=n;j.isVirtual;)j=j.parent;k=j.domNode;var P=B.first(function(e,n){return e===k},!0);if(P&&P[0].parentNode&&(T[P[1]]=!0),n.refreshAttributes&&n.attributes)for(var D in n.refreshAttributes=!1,n.attributes)I(k,n.attributes[D])}else switch(n.type){case"text":if(e.doctype){k=e.doctype;break}var M=!1,z=O(n);if(o&&null==z)return;if(!M)if(z&&"text"==z.node.type)z.node.domNode.nodeValue+=_,null!==n.domNode&&(n.domNode.parentNode.removeChild(n.domNode),n.domNode=null);else if(null!==n.domNode&&n.domNode.parentNode===e)n.domNode.nodeValue!==_&&(n.domNode.nodeValue=_),k=n.domNode;else{k=document.createTextNode(_);var K=z.node.domNode.nextSibling;z.itsParent||null===K?z.itsParent?z.node.domNode.childNodes.length>0?z.node.domNode.insertBefore(k,z.node.domNode.childNodes[0]):z.node.domNode.appendChild(k):(z.node.domNode.parentNode||e).appendChild(k):K.parentNode.insertBefore(k,K),n.domNode=k}break;case"tag":if(e.documentElement){k=e.documentElement,n.domNode=k,T[0]=!0,T[1]=!0;break}if(!h&&_ in a){var q=k=document.createElement(_);if(n.domNode=k,S(q,n,n.children,E,r),n.attributes)for(var D in n.attributes)I(q,n.attributes[D]);var F=B.first(function(e,n){return!(n in T)&&e.isEqualNode(q)},!0);if(F){T[F[1]]=!0,n.domNode=F[0];z=O(n),K=z.node.domNode.nextSibling;z.itsParent||null===K?z.itsParent?z.node.domNode.appendChild(F[0]):z.node.domNode.parentNode.appendChild(F[0]):K.parentNode.insertBefore(F[0],K);break}if(!F&&(F=p.first(function(e){return e.isEqualNode(q)}),F)){n.domNode=F;z=O(n),K=z.node.domNode.nextSibling;z.itsParent||null===K?z.itsParent?z.node.domNode.appendChild(F):z.node.domNode.parentNode.appendChild(F):K.parentNode.insertBefore(F,K);break}}if(!h&&"head"===_){var J=B.first(function(e){return e.nodeName.toLowerCase()===_},!0);k=J[0],T[J[1]]=!0,n.domNode=k;break}var Y=R?B.first(function(e,n){return e.nodeName.toLowerCase()===_&&!(n in T)},!0):null;if(Y&&Y[0].parentNode){if(T[Y[1]]=!0,L==Y[1]){k=Y[0],n.domNode=k;break}Y[1]in T||Y[0].parentNode.removeChild(Y[0])}if(k=document.createElement(_),null!==n.domNode&&n.domNode.parentNode)n.domNode.parentNode.replaceChild(k,n.domNode),n.children&&H(n.children);else{z=O(n);if(null==z)return;K=z.node.domNode.nextSibling;z.itsParent||null===K?z.itsParent?z.node.domNode.childNodes.length>0?z.node.domNode.insertBefore(k,z.node.domNode.childNodes[0]):z.node.domNode.appendChild(k):(z.node.domNode.parentNode||e).appendChild(k):K.parentNode.insertBefore(k,K)}if(n.domNode=k,_ in a&&p.push(k),n.attributes)for(var D in n.attributes)I(k,n.attributes[D]);break;case"comment":if(k=document.createComment(_),null!==n.domNode)n.domNode.parentNode.replaceChild(k,n.domNode);else{z=O(n);if(null==z)return;K=z.node.domNode.nextSibling;z.itsParent||null===K?z.itsParent?z.node.domNode.childNodes.length>0?z.node.domNode.insertBefore(k,z.node.domNode.childNodes[0]):z.node.domNode.appendChild(k):z.node.domNode.parentNode.appendChild(k):K.parentNode.insertBefore(k,K)}n.domNode=k;break;case"if":usedSubscriptions={},n.instance.component||(n.instance.component=C(n.instance));w=[n.instance.component,t];if(n.scope)for(var x in n.scope.stack)w.push(n.scope.data[n.scope.stack[x]]);var Q=!!n.condition.func.apply(null,w);if(void 0!==n.condition.value&&Q===n.condition.value&&"template"!==_)return;n.condition.value=Q,k=e,n.parentDomNode=e,n.condition.previousValue=n.condition.value,n.topRealPreviousNode=n.parent&&n.parent.topRealPreviousNode||n.previousNode,E=!0;break;case"else-if":n.instance.component||(n.instance.component=C(n.instance));w=[n.instance.component,t];if(n.scope)for(var x in n.scope.stack)w.push(n.scope.data[n.scope.stack[x]]);Q=!n.previousNode.condition.value&&!!n.condition.func.apply(null,w);if(n.condition.previousValue=n.previousNode.condition.value||Q,void 0!==n.condition.value&&Q===n.condition.value&&"template"!==_)return;n.condition.value=Q,k=e,n.parentDomNode=e,n.topRealPreviousNode=n.parent&&n.parent.topRealPreviousNode||n.previousNode,E=!0;break;case"else":Q=!n.previousNode.condition.previousValue;if(void 0!==n.condition.value&&Q===n.condition.value&&"template"!==_)return;n.condition.value=Q,k=e,n.parentDomNode=e,n.topRealPreviousNode=n.parent&&n.parent.topRealPreviousNode||n.previousNode,E=!0;break;case"template":k=e,E=!0;break;case"foreach":if(k=e,E=!0,k){n.itemChildren||(n.itemChildren=n.children),n.instance.component||(n.instance.component=C(n.instance));w=[n.instance.component,t];if(n.scope)for(var x in n.scope.stack)w.push(n.scope.data[n.scope.stack[x]]);var X=n.forExpression.data.apply(null,w),Z=null,ee=Array.isArray(X),ne={},te={},oe=[];for(var x in X){var re=ee?+x:x,ie=!1;if(n.children)for(g=0;g<n.children.length;g++)if(!(x in ne||g in te)&&n.children[g].foreachData===X[x]){ne[x]=!0,n.children[g].previousNode=Z,Z&&(Z.nextNode=n.children[g]),Z=n.children[g],n.children[g].scope.data[n.forExpression.key]=re,oe.push(n.children[g]),te[g]=!0,ie=!0;break}if(!ie){var se={type:"template",isVirtual:!0,parent:n,previousNode:Z,instance:Object.assign({},n.instance),domNode:null,scope:n.scope,foreachData:X[x],foreachKey:re};se.scope={parentScope:n.scope,data:Object.assign({},n.scope.data),stack:n.scope.stack.slice()},Z&&(Z.nextNode=se),Z=se,se.scope.stack.push(n.forExpression.key),se.scope.stack.push(n.forExpression.value),se.scope.data[n.forExpression.key]=re,se.scope.data[n.forExpression.value]=X[x],W(se,n.itemChildren),oe.push(se)}}if(null!=n.children)if(oe.length>0)for(g=n.children.length-1;g>=0;g--)g in te||H([n.children[g]]);else H(n.children);oe.length>0?n.children=oe:n.children=null}break;case"dynamic":if(k=e,E=!0,n.latestVal===_)return;H(n.children),n.children=null;se={contents:n.contents,attributes:n.attributes,parent:n,previousNode:null,scope:n.scope,instance:n.instance,domNode:null};if(n.itemChildren&&U(se,n.itemChildren),_ in i)se.type="tag",se.root=n.root;else{var ae=ce(_,se.children,n.attributes);C(ae.wrapper),V(ae.wrapper),ve(ae.root),se.type="template",se.isVirtual=!0,se.children=ae.versions.main,se.children.each(function(e){e.parent=se})}n.children=[se],n.latestVal=_;break;case"raw":if(k=e,E=!0,n.latestHtml===_){if(n.rawNodes)for(g=0;g<n.rawNodes.length;g++)n.rawNodes[g].domNode.usedByRenderer=!0;return}n.latestHtml=_,n.rawNodes&&H(n.rawNodes),n.children=null,n.rawNodes=null;var de=$(n);if(de){var le=document.createElement(de.domNode.nodeName);if(le.innerHTML=_,le.childNodes.length>0){var pe=0,ue=O(n);ue.itsParent||"text"!==ue.node.type||3!==le.childNodes[0].nodeType||(ue.node.domNode.nodeValue+=le.childNodes[0].nodeValue,pe=1);for(var fe=[];pe<le.childNodes.length;pe++)fe.push({domNode:le.childNodes[pe]});K=ue.node.domNode.nextSibling;if(fe.length>0){for(g=0;g<fe.length;g++)!ue.itsParent&&K?K.parentNode.insertBefore(fe[g].domNode,K):ue.itsParent?ue.node.domNode.appendChild(fe[g].domNode):ue.node.domNode.parentNode.appendChild(fe[g].domNode);var he=fe[fe.length-1];n.children=[{type:3===he.domNode.nodeType?"text":"tag",parent:n,previousNode:null,scope:n.scope,instance:n.instance,domNode:he.domNode}],n.rawNodes=fe}}}if(n.rawNodes)for(g=0;g<n.rawNodes.length;g++)n.rawNodes[g].domNode.usedByRenderer=!0;if(n.subs&&!n.subscribed){for(var me in n.subs)G(n,n.subs[me]);n.subscribed=!0}return;default:throw new Error("Node type '"+n.type+"' is not implemented.")}if(!n.isVirtual&&k&&n.root&&(n.instance.component._element=k),k&&(k.usedByRenderer=!0),n.subs&&!n.subscribed){for(var me in n.subs)G(n,n.subs[me]);n.subscribed=!0}k&&S(k,n,n.children,E,r)}}},P=null,B=[],T={},R=!1,L=0,S=function(e,n,t,o,r){var i=P,s=B,a=T;if(P=e,e.childNodes&&!n.isVirtual)for(var c=0;c<e.childNodes.length;c++)"usedByRenderer"in e.childNodes[c]&&(e.childNodes[c].usedByRenderer=!1);for(var c in R&&e!==i&&(B=Array.prototype.slice.call(P.childNodes),T={}),t){var d=B.first(function(e,n){return e===t[c].domNode},!0);d&&d[0].parentNode&&(T[d[1]]=!0)}for(var c in t)L=c,t[c].childInstances&&ve(t[c]),A(e,t[c],o,r);if(e.childNodes&&!n.isVirtual)for(c=e.childNodes.length-1;c>=0;c--)e.childNodes[c].usedByRenderer||"usedByRenderer"in e.childNodes[c]&&e.removeChild(e.childNodes[c]);P=i,B=s,T=a},$=function(e){return e.parent?e.parent.domNode?e.parent:$(e.parent):null},H=function(e,n){for(var t in e)if(e[t].children&&H(e[t].children,n),e[t].domNode&&(e[t].domNode.parentNode&&e[t].domNode.parentNode.removeChild(e[t].domNode),e[t].domNode=null),_.includes(e[t].type)&&delete e[t].condition.value,e[t].latestVal&&delete e[t].latestVal,e[t].skipIteration&&(e[t].skipIteration=!1),e[t].origin)for(var o in e[t].origin)e[t].origin[o]&&(e[t].origin[o].skipIteration=!1,e[t].origin[o].domNode=null,e[t].origin[o]=null)},D={},M=!1,W=function(e,n){D={},M=!0,U(e,n),M=!1},U=function(e,n){var t=null,o=n.select(function(n){var o=z(e,n);return o.parent=e,o.previousNode=t,t=o,o.previousNode&&(o.previousNode.nextNode=o),o});e.itemChildren?e.itemChildren=o:e.children=o},z=function(e,n){var t=Object.assign({},n);return n.cloned=!0,delete t.cloned,delete t.subscribed,t.nextNode=null,t.previousNode=null,t.domNode=null,t.scope=e.scope||t.scope,n.condition&&(_.includes(n.type)?t.condition=Object.assign({},n.condition):t.condition=e.condition),M&&(t.instance.component||(t.instance.__id in D?t.instance=D[t.instance.__id]:(t.instance=Object.assign({},n.instance),D[t.instance.__id]=t.instance,t.instance.__id=++K,D[t.instance.__id]=t.instance),t.instance.attributes=t.instance.attributes.select(function(e){var n=Object.assign({},e);return n.scope=t.scope||n.scope,n.origin=Object.assign({},e.origin),delete n.childComponent,n})),n.childInstances&&(t.childInstances=n.childInstances.select(function(e){if(!e.wrapper.component){var n=Object.assign({},e);return e.wrapper.__id in D?n.wrapper=D[e.wrapper.__id]:(n.wrapper=Object.assign({},e.wrapper),D[n.wrapper.__id]=n.wrapper,n.wrapper.__id=++K,D[n.wrapper.__id]=n.wrapper,n.wrapper.attributes=e.wrapper.attributes.select(function(e){var n=Object.assign({},e);return n.scope=t.scope||n.scope,n})),n}return e})),t.contents=t.contents.select(function(e){var n=Object.assign({},e);return n.call&&n.instance.__id in D&&(n.instance=D[n.instance.__id]),n})),t.attributes&&(t.attributes=t.attributes.select(function(e){var o=Object.assign({},e);return o.parent=t,e.cloned=!0,delete o.cloned,delete o.subscribed,M&&!o.instance.component&&(o.instance.__id in D?o.instance=D[o.instance.__id]:(o.instance=Object.assign({},n.instance),D[o.instance.__id]=o.instance,o.instance.__id=++K,D[o.instance.__id]=o.instance,o.instance.attributes=o.instance.attributes.select(function(e){var n=Object.assign({},e);return n.scope=o.scope||n.scope,n}))),o.scope=t.scope||o.scope,e.children&&(e.children=e.children.select(function(e){var n=Object.assign({},e);return n.parent=t,e.cloned=!0,delete n.cloned,delete n.subscribed,n})),o})),(n.children||n.itemChildren)&&U(t,n.children||n.itemChildren),t},K=0,q=function(e,n){return"__id"in e||Object.defineProperty(e,"__id",{enumerable:!1,writable:!1,value:n||++K}),e.__id},F={},J={},Y={},G=function(e,n){var t=e.isAttribute,o=t?e.parent.instance:e.instance,r=q(o);r in J||(J[r]={});for(var i=n.split("."),s=i[0],a=[],c=1;c<i.length;c++)s=s+"."+i[c],a.push(s);for(c=0;c<a.length;c++){var d=a[c];if(d in J[r]||(J[r][d]=[]),J[r][d].push(e),d in Y){var l=Y[d],p=l.instance,u=l.subs,f=q(p);for(var h in f in J||(J[f]={}),u){var m=u[h];m in J[f]||(J[f][m]=[]),J[f][m].push(e)}}}},Q=function(){var e=F;for(var n in F={},we++,e)for(var o in e[n])try{var r=e[n][o];if(r.isAttribute){var i="dynamic"===r.parent.type?r.parent.children&&r.parent.children.length>0&&r.parent.children[0].domNode:r.parent.domNode;if(i&&I(i,r),"component"===r.parent.type&&r.childComponent){var s=[r.instance.component,t];if(r.scope)for(var a in r.scope.stack)s.push(r.scope.data[r.scope.stack[a]]);currentValue=null;for(var c=0;c<r.children.length;c++){var d=r.children[c].propExpression.call?r.children[c].propExpression.func.apply(null,s):r.children[c].propExpression.content;currentValue=0===c?d:currentValue+d}r.childComponent[r.content]=currentValue}}else if(r.isVirtual)A(r.parentDomNode,r);else{var l=r.domNode&&r.domNode.parentNode;if(!l){var p=O(r);l=p&&p.node.domNode&&p.node.domNode.parentNode}l&&A(l,r)}}catch(e){console.error(e)}Object.keys(F).length>0&&Q()},X=function(e){for(var n in e.subs){var t=e.subs[n],o=t.id;o in J&&t.path in J[o]&&(F[o+"_"+t.path]=J[o][t.path],setTimeout(function(){Q()},0))}};this.notify=function(e,n){if(Array.isArray(e)){var t=Object.getPrototypeOf(e);t.deps&&X(t.deps)}};var Z=function(e,n){var t=Object.getPrototypeOf(e);if(!("deps"in t)){var o={};return Object.defineProperty(o,"deps",{enumerable:!1,writable:!1,value:n}),Object.setPrototypeOf(o,t),Object.setPrototypeOf(e,o),e}for(var r in n)for(var i in r in e.deps||(e.deps[r]={}),n[r])e.deps[r][i]=n[r][i]},ee=function(e){var n=arguments.length>1?arguments[1]:e,t=arguments.length>2?arguments[2]:"this",o=arguments.length>3?arguments[3]:{subs:{}};if(Array.isArray(e)){Z(e,o);for(var r=0;r<e.length;r++)null!==e[r]&&"object"==typeof e[r]&&ee(e[r],n,t+"[key]")}else{var i=Object.keys(e);for(r=0;r<i.length;r++)te(n,t+"."+i[r],e,i[r]),te(n,t+"[key]",e,i[r])}return e},ne=null,te=function(e,n,t,o){ne=null;var r=null,i=t[o],s=!1;if(ne?r=ne:(r={subs:{}},s=!0),null!==i&&"object"==typeof i&&ee(i,e,n,r),"function"!=typeof i){var a=q(e);r.subs[a+n]={instance:e,id:a,path:n},s&&Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:function(){return ne=r,i},set:function(t){t!==i&&(X(r),i=t,null!==i&&"object"==typeof i&&ee(i,e,n,r))}})}},oe={},re=function(e,o,r){var i=t.components[e];if(!i)return null;var s=i.dependencies,a=i.service;if(a&&e in oe)return oe[e];if(!s){var c=new(n(e));return i.init&&c.__init(),q(c,r),ee(c),a&&(oe[e]=c),c}var arguments=[null];for(var d in s){var l=s[d],p=null;p=o&&l.argName in o?o[l.argName]:l.default?l.default:l.null?null:l.builtIn?"string"===l.name?"":0:re(l.name),arguments.push(p)}c=i.init?new(n(e)):new(n(e).bind.apply(n(e),arguments));return i.init&&(arguments.shift(),c.__init.apply(c,arguments)),q(c,r),ee(c),a&&(oe[e]=c),c},ie=function(e,n){var t=e.length,o=n.length;if(t==o){for(l=0;l<t;l++)if(l<o){var r=!0,i=!1,s=e[l].contents&&e[l].contents.select(function(e){return e.content||e.code}).join(),a=n[l].contents&&n[l].contents.select(function(e){return e.content||e.code}).join();e[l].instance.name!=n[l].instance.name&&(r=!1),s!=a&&(r=!1);var c=e[l].attributes&&e[l].attributes.select(function(e){return(e.content||"")+(e.children&&";"+e.children.select(function(e){return e.contentExpression.content||e.contentExpression.code||""}).join(";")||"")}).join(";"),d=n[l].attributes&&n[l].attributes.select(function(e){return(e.content||"")+(e.children&&";"+e.children.select(function(e){return e.contentExpression.content||e.contentExpression.code||""}).join(";")||"")}).join(";");c!=d&&(r=!1),r||"dynamic"===e[l].type&&"dynamic"===n[l].type?(i=e[l].contents&&e[l].contents.first(function(e){return e.code}),e[l].domNode=n[l].domNode,e[l].skipIteration=!e[l].isVirtual&&!!n[l].domNode&&!i,e[l].skipIteration&&(n[l].origin||(n[l].origin={}),n[l].origin[e[l].id]=e[l],e[l].refreshAttributes=e[l].attributes&&e[l].attributes.first(function(e){return e.children&&e.children.first(function(e){return e.contentExpression.code})}),e[l].refreshAttributes&&e[l].attributes.each(function(e,t){e.latestValue=n[l].attributes[t].latestValue,e.listeners=n[l].attributes[t].listeners})),n[l].rawNodes&&(e[l].rawNodes=n[l].rawNodes,e[l].latestHtml=n[l].latestHtml),e[l].children&&n[l].children&&ie(e[l].children,n[l].children)):(n[l].domNode&&n[l].domNode.parentNode?n[l].domNode.parentNode.removeChild(n[l].domNode):n[l].isVirtual&&(e[l].previousNode&&"text"===e[l].previousNode.type&&e[l].previousNode.skipIteration&&(e[l].previousNode.skipIteration=!1,H([e[l].previousNode])),H(n[l].children)),e[l].children&&H(e[l].children),n[l].rawNodes&&(e[l].rawNodes=n[l].rawNodes,e[l].latestHtml=n[l].latestHtml))}}else{H(n);for(var l=0;l<t;l++)e[l].skipIteration&&(e[l].skipIteration=!1,e[l].domNode=null,e[l].children&&H(e[l].children,!0))}},se=null,ae=function(e){return e?e.select(function(e){return Object.assign({},e)}):null},ce=function(e,n,o,r,i){if(!(e in t.components))throw new Error("Component "+e+" doesn't exist.");var s=null,a=null;if(he){var c=le.components.first(function(n){return n.name===e},!0);c&&(le.components.splice(c[1],1),s=c[0].build,a=c[0].instanceWrapper,a.isMounted=!1,a.attributes=ae(o),a.params=r)}var d=se;se=e;var l=t.components[e];a=a||{component:null,name:e,isMounted:!1,isCreated:!1,params:r,hasVersions:l.hasVersions,attributes:ae(o),__id:++K};var p={isRoot:!0},u={root:p,versions:{},wrapper:a};if(l.hasVersions)for(var f in l.versions)u.versions[f]=E(l.versions[f],a,n,p,i),s&&ie(u.versions[f],s.versions[f]);else u.versions.main=E(l.nodes,a,n,p,i),s&&ie(u.versions.main,s.versions.main);for(var f in u.versions)for(var h=0;h<u.versions[f].length;h++)u.versions[f][h].root=!0;return se=d,he&&de.components.push({name:e,build:u,instanceWrapper:a}),u},de={name:null,nodes:null,components:[]},le={name:null,nodes:null,components:[]},pe=function(e,n){if(e.children)for(var t in e.children)e.children[t].domNode?n.push(e.children[t]):e.children[t].isVirtual&&pe(e.children[t],n)},ue=/^\s+|\s+$/,fe=function(e,n){var t=e.domNode.nodeType===n.nodeType;if(t){if(3===e.domNode.nodeType||8==e.domNode.nodeType)t=e.domNode.nodeValue.replace(ue,"")==n.nodeValue.replace(ue,""),t&&(e.domNode=n);else if(1===e.domNode.nodeType&&(t=e.domNode.nodeName==n.nodeName,t)){var o=e.domNode;e.domNode=n,!e.isVirtual&&n&&e.root&&e.instance&&e.instance.component&&(e.instance.component._element=n);var r=0,i=0,s=n.childNodes.length,a=e.children?e.children.length:0;e.children&&e.children.length>0&&(e.children[a-1].domNode&&3===e.children[a-1].domNode.nodeType&&(0==n.childNodes.length||3!==n.childNodes[s-1].nodeType)&&/^\s*$/.test(e.children[a-1].domNode.nodeValue)&&n.appendChild(e.children[a-1].domNode),
e.children[0].domNode&&3===e.children[0].domNode.nodeType&&3!==n.childNodes[0].nodeType&&/^\s*$/.test(e.children[0].domNode.nodeValue)&&n.insertBefore(e.children[0].domNode,n.childNodes[0]),a=e.children.length,s=n.childNodes.length);for(var c=[],d=[],l=0;l<a;l++)e.children[l].rawNodes?d=d.concat(e.children[l].rawNodes):e.children[l].isVirtual?pe(e.children[l],d):d.push(e.children[l]);var p=d.length;for(l=0;l+i<s;l++){for(;l+r<p&&!d[l+r].domNode;)r++;if(l+r<p)if(d[l+r].type){var u=fe(d[l+r],n.childNodes[l+i]);if(!u){for(var f=!1,h=l+i+1;h<s;h++)if(f=fe(d[l+r],n.childNodes[h]),f){for(var m=l+i;m<h;m++)c.push(m);i+=h-(l+i);break}if(f)continue;e.domNode!==d[l+r].domNode.parentNode?(e.domNode.childNodes.length>l+i?e.domNode.replaceChild(d[l+r].domNode,e.domNode.childNodes[l+i]):e.domNode.appendChild(d[l+r].domNode),fe(d[l+r],n.childNodes[l+i])):c.push(l)}}else d[l+r].domNode=n.childNodes[l+i];else c.push(l+i)}for(l=s;l+r<p;l++)d[l+r].domNode&&e.domNode.appendChild(d[l+r].domNode);if(c.length>0)for(var v=c.length-1;v>=0;v--){var N=c[v];["BODY","HEAD"].includes(n.childNodes[N].nodeName)?n.replaceChild(e.children.first(function(e){return e.domNode.nodeName&&e.domNode.nodeName===n.childNodes[N].nodeName}).domNode,n.childNodes[N]):n.removeChild(n.childNodes[N])}if(s=n.childNodes.length,s>p)for(v=s-1;v>=p;v--)n.removeChild(n.childNodes[v]);if(p>s)for(v=s;v<p;v++)d[v].domNode&&!d[v].type&&n.appendChild(d[v].domNode);if(e.attributes)for(var b in e.attributes)I(e.domNode,e.attributes[b],!0);for(var g=o.getAttributeNames(),y=e.domNode.getAttributeNames(),w=0;w<g.length;w++){var x=g[w],_=o.getAttribute(x);e.domNode.getAttribute(x)!==_&&e.domNode.setAttribute(x,_)}for(w=0;w<y.length;w++){x=y[w];o.hasAttribute(x)||e.domNode.removeAttribute(x)}}e.domNode&&(e.domNode.usedByRenderer=!0)}return t},he=!1,me=!1,ve=function(e){if(e.childInstances)for(var n in e.childInstances)C(e.childInstances[n].wrapper),V(e.childInstances[n].wrapper),e.childInstances[n].root.childInstances&&ve(e.childInstances[n].root)},Ne={},be=!1,ge=!1,ye=!1,we=0;this.render=function(n,o,i){if(!n)throw new Error("Component name is required.");if(!(n in t.components))throw new Error("Component "+n+" doesn't exist.");if(t.components[n].lazyLoad){var s=t.components[n].lazyLoad,a=VIEWI_PATH+"/"+s+".group.json"+VIEWI_VERSION,c=!1;r.get(a).then(function(e){for(var r in e)delete t.components[r].lazyLoad,t.components[r]=Object.assign(t.components[r],e[r]),r===n&&(c=!0);c?t.render(n,o,i):console.error('Component "'+n+'" was not found in the group: '+a)},function(){console.error("Failed to lazy load the component in the group: "+a)})}else{if(Ne={},!i&&e[n]&&e[n]._beforeStart){var d=e[n]._beforeStart;if(d.length>0){var l=d.length-1,p=d[l],u=re(p),f=function(){var e=!(arguments.length>0)||arguments[0];e&&(l>0?(l--,p=d[l],u=re(p),u.run(f)):t.render(n,o,!0))};return void u.run(f)}}be&&(ge=!0);var m=function(){for(var e=0;e<le.components.length;e++){var n=le.components[e];n.instanceWrapper&&n.instanceWrapper.component&&n.instanceWrapper.component.__destroy&&n.instanceWrapper.component.__destroy()}};be=!0,he=!1,J={},F={},se=null,ge&&m(),le=de,de={},de.name=n,de.components=[];var v=ce(n,null,null,o,!0),N=v.versions.main;de.nodes=N,me&&window.scrollTo(0,0),me=!0,R=!h;var b=h?{documentElement:document.createElement("html"),doctype:{}}:document;if(C(v.wrapper),ye)return m(),void(ye=!1);if(V(v.wrapper),ye)return m(),void(ye=!1);if(ve(v.root),ye)return m(),void(ye=!1);m(),we++,S(b,{},N,!1);var g=N[1];for(var y in g||"dynamic"!==N[0].type||(g=N[0].children[0].children[1]),h&&fe(g,document.documentElement),Ne)Ne[y].component.__rendered&&Ne[y].component.__rendered();be=!1,ge&&(ge=!1,ye=!0),Ne={},R=!1,h=!1}},this.htmlentities=function(e){return e};var xe=document.createElement("div");this.decode=function(e){return xe.innerHTML=e,xe.value}}var o=n("Router"),r=n("ajax");e.Viewi=t})(viewiExports,viewiBring);